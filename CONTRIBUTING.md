# –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –≤–Ω–µ—Å–µ–Ω–∏—é –≤–∫–ª–∞–¥–∞ –≤ VoiceToNights

–°–ø–∞—Å–∏–±–æ –∑–∞ –∏–Ω—Ç–µ—Ä–µ—Å –∫ –ø—Ä–æ–µ–∫—Ç—É VoiceToNights! –≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –æ–ø–∏—Å—ã–≤–∞–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∏ –ø—Ä–∏–Ω—Ü–∏–ø—ã –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –ø—Ä–æ–µ–∫—Ç–∞.

## –ü—Ä–∏–Ω—Ü–∏–ø—ã –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

### –ü—Ä–æ–∑—Ä–∞—á–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (Transparent Architecture)

–ü—Ä–æ–µ–∫—Ç –ø–æ—Å—Ç—Ä–æ–µ–Ω –Ω–∞ –ø—Ä–∏–Ω—Ü–∏–ø–∞—Ö **–ø—Ä–æ–∑—Ä–∞—á–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã**, —á—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç:

1. **–ß–µ—Ç–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏** ‚Äî –∫–∞–∂–¥—ã–π –º–æ–¥—É–ª—å –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –æ–¥–Ω—É –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é –∑–∞–¥–∞—á—É
2. **–ù–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤** ‚Äî –º–æ–¥—É–ª–∏ —Å–ª–∞–±–æ —Å–≤—è–∑–∞–Ω—ã –º–µ–∂–¥—É —Å–æ–±–æ–π –∏ –º–æ–≥—É—Ç –±—ã—Ç—å –ª–µ–≥–∫–æ –∑–∞–º–µ–Ω–µ–Ω—ã
3. **–ü–æ–Ω—è—Ç–Ω—ã–π –ø–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö** ‚Äî –ª–µ–≥–∫–æ –ø—Ä–æ—Å–ª–µ–¥–∏—Ç—å, –∫–∞–∫ –¥–∞–Ω–Ω—ã–µ –ø—Ä–æ—Ö–æ–¥—è—Ç —á–µ—Ä–µ–∑ —Å–∏—Å—Ç–µ–º—É
4. **–ú–∏–Ω–∏–º—É–º —Å–∫—Ä—ã—Ç—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π** ‚Äî –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —è–≤–Ω–æ –≤–∏–¥–Ω—ã –≤ –∫–æ–¥–µ
5. **–õ–µ–≥–∫–∞—è —Ç–µ—Å—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å** ‚Äî –∫–∞–∂–¥—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –º–æ–∂–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
VoiceToNights/
‚îú‚îÄ‚îÄ main.py                 # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ ‚Äî —Ç–æ–ª—å–∫–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏ –∑–∞–ø—É—Å–∫
‚îú‚îÄ‚îÄ config.json             # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ prompts.json            # –ü—Ä–æ–º–ø—Ç—ã –¥–ª—è LLM (—Å–∏—Å—Ç–µ–º–Ω—ã–µ –ø—Ä–æ–º–ø—Ç—ã)
‚îú‚îÄ‚îÄ core/                   # –ù–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–µ –º–æ–¥—É–ª–∏
‚îÇ   ‚îî‚îÄ‚îÄ voice_recorder.py   # –ó–∞–ø–∏—Å—å –≥–æ–ª–æ—Å–∞ (VAD, –º–∏–∫—Ä–æ—Ñ–æ–Ω)
‚îú‚îÄ‚îÄ src/                    # –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã
‚îÇ   ‚îú‚îÄ‚îÄ config.py           # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π (dataclass)
‚îÇ   ‚îú‚îÄ‚îÄ stt.py              # Speech-to-Text (Whisper)
‚îÇ   ‚îú‚îÄ‚îÄ llm.py              # LLM –∫–ª–∏–µ–Ω—Ç (Ollama)
‚îÇ   ‚îú‚îÄ‚îÄ tts.py              # Text-to-Speech (Silero)
‚îÇ   ‚îú‚îÄ‚îÄ prompts.py          # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–º–ø—Ç–∞–º–∏ –∏–∑ prompts.json
‚îÇ   ‚îî‚îÄ‚îÄ server.py           # –û—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ (–∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—è –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ–º –º–µ–∂–¥—É –º–æ–¥—É–ª—è–º–∏ —Å–∏—Å—Ç–µ–º—ã)
```

### –ü—Ä–∏–Ω—Ü–∏–ø—ã –º–æ–¥—É–ª—å–Ω–æ—Å—Ç–∏

–ö–∞–∂–¥—ã–π –º–æ–¥—É–ª—å –¥–æ–ª–∂–µ–Ω:

- **–ò–º–µ—Ç—å –æ–¥–Ω—É –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å** ‚Äî –º–æ–¥—É–ª—å —Ä–µ—à–∞–µ—Ç –æ–¥–Ω—É –∑–∞–¥–∞—á—É
- **–ë—ã—Ç—å —Å–∞–º–æ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–º** ‚Äî –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –≤–Ω–µ—à–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- **–ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—Ç—å –ø—Ä–æ—Å—Ç–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å** ‚Äî –ø–æ–Ω—è—Ç–Ω—ã–µ –º–µ—Ç–æ–¥—ã –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
- **–ë—ã—Ç—å –ª–µ–≥–∫–æ –∑–∞–º–µ–Ω—è–µ–º—ã–º** ‚Äî –º–æ–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è –æ—Å—Ç–∞–ª—å–Ω–æ–≥–æ –∫–æ–¥–∞

## –ü—Ä–æ—Ü–µ—Å—Å —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

### 1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è

1. **–ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:**
   ```bash
   git clone <repository-url>
   cd VoiceToNights
   ```

2. **–°–æ–∑–¥–∞–π—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ:**
   ```bash
   python -m venv venv
   # Windows
   venv\Scripts\activate
   # Linux/Mac
   source venv/bin/activate
   ```

3. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
   ```bash
   pip install -r requirements.txt
   ```

4. **–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ Ollama —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –∏ –∑–∞–ø—É—â–µ–Ω–∞:**
   ```bash
   # –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Ollama (–µ—Å–ª–∏ –µ—â–µ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞)
   # Windows: —Å–∫–∞—á–∞–π—Ç–µ —Å https://ollama.ai
   # Linux/Mac: curl -fsSL https://ollama.ai/install.sh | sh
   
   # –ó–∞–ø—É—Å—Ç–∏—Ç–µ Ollama —Å–µ—Ä–≤–µ—Ä
   ollama serve
   
   # –°–∫–∞—á–∞–π—Ç–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—É—é –º–æ–¥–µ–ª—å (–≤ –¥—Ä—É–≥–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ)
   ollama pull llama3.1:8b
   ```

5. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ ffmpeg (–¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∞—É–¥–∏–æ):**
   ```bash
   # Windows
   winget install ffmpeg
   
   # Linux (Ubuntu/Debian)
   sudo apt install ffmpeg
   
   # Mac
   brew install ffmpeg
   ```

### 2. –†–∞–±–æ—á–∏–π –ø—Ä–æ—Ü–µ—Å—Å

#### –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π –≤–µ—Ç–∫–∏

```bash
git checkout -b feature/–Ω–∞–∑–≤–∞–Ω–∏–µ-—Ñ—É–Ω–∫—Ü–∏–∏
# –∏–ª–∏
git checkout -b fix/–æ–ø–∏—Å–∞–Ω–∏–µ-–±–∞–≥–∞
```

#### –í–Ω–µ—Å–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π

1. **–°–ª–µ–¥—É–π—Ç–µ –ø—Ä–∏–Ω—Ü–∏–ø–∞–º –ø—Ä–æ–∑—Ä–∞—á–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã:**
   - –ï—Å–ª–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç–µ –Ω–æ–≤—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç, —Å–æ–∑–¥–∞–π—Ç–µ –æ—Ç–¥–µ–ª—å–Ω—ã–π –º–æ–¥—É–ª—å
   - –ù–µ —Å–º–µ—à–∏–≤–∞–π—Ç–µ –ª–æ–≥–∏–∫—É —Ä–∞–∑–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ dataclass –¥–ª—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏, –µ—Å–ª–∏ –Ω—É–∂–Ω–æ

2. **–°–æ–±–ª—é–¥–∞–π—Ç–µ —Å—Ç–∏–ª—å –∫–æ–¥–∞:**
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ type hints (`from __future__ import annotations`)
   - –ü–∏—à–∏—Ç–µ docstrings –¥–ª—è –∫–ª–∞—Å—Å–æ–≤ –∏ –º–µ—Ç–æ–¥–æ–≤
   - –°–ª–µ–¥—É–π—Ç–µ PEP 8

3. **–ü—Ä–∏–º–µ—Ä –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –º–æ–¥—É–ª—è:**
   ```python
   """–ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –º–æ–¥—É–ª—è."""

   from __future__ import annotations

   from pathlib import Path

   from .config import AppConfig

   class MyComponent:
       """–û–ø–∏—Å–∞–Ω–∏–µ –∫–ª–∞—Å—Å–∞."""

       def __init__(self, config: AppConfig):
           """
           –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∫–æ–º–ø–æ–Ω–µ–Ω—Ç.

           Args:
               config: –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞
           """
           self.config = config

       def do_something(self, input_data: str) -> str:
           """
           –í—ã–ø–æ–ª–Ω—è–µ—Ç –¥–µ–π—Å—Ç–≤–∏–µ.

           Args:
               input_data: –í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

           Returns:
               –†–µ–∑—É–ª—å—Ç–∞—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏
           """
           # –†–µ–∞–ª–∏–∑–∞—Ü–∏—è
           return result
   ```

### 3. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ü–µ—Ä–µ–¥ –∫–æ–º–º–∏—Ç–æ–º —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ:

1. **–ö–æ–¥ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫:**
   ```bash
   python main.py
   ```

2. **–ù–æ–≤—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ** ‚Äî –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –≤—Ä—É—á–Ω—É—é

3. **–ù–µ —Å–ª–æ–º–∞–ª–∏ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª** ‚Äî –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –±–∞–∑–æ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏

### 4. –ö–æ–º–º–∏—Ç—ã

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–æ–Ω—è—Ç–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –∫–æ–º–º–∏—Ç–æ–≤:

```bash
git commit -m "feat: –¥–æ–±–∞–≤–ª–µ–Ω –º–æ–¥—É–ª—å –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∂–µ—Å—Ç–æ–≤"
git commit -m "fix: –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–ª–∏–Ω–Ω—ã—Ö –∞—É–¥–∏–æ –≤ STT"
git commit -m "refactor: –≤—ã–Ω–µ—Å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é TTS –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π –∫–ª–∞—Å—Å"
```

–ü—Ä–µ—Ñ–∏–∫—Å—ã:
- `feat:` ‚Äî –Ω–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
- `fix:` ‚Äî –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–∞–≥–∞
- `refactor:` ‚Äî —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏
- `docs:` ‚Äî –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
- `style:` ‚Äî —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞
- `perf:` ‚Äî —É–ª—É—á—à–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### 5. Pull Request

1. **–ü–µ—Ä–µ–¥ —Å–æ–∑–¥–∞–Ω–∏–µ–º PR:**
   - –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∫–æ–¥ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ø—Ä–∏–Ω—Ü–∏–ø–∞–º –ø—Ä–æ–∑—Ä–∞—á–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤—Å–µ –º–æ–¥—É–ª–∏ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã –∏ –ª–µ–≥–∫–æ —Ç–µ—Å—Ç–∏—Ä—É–µ–º—ã
   - –û–±–Ω–æ–≤–∏—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é, –µ—Å–ª–∏ –¥–æ–±–∞–≤–∏–ª–∏ –Ω–æ–≤—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª

2. **–û–ø–∏—Å–∞–Ω–∏–µ PR –¥–æ–ª–∂–Ω–æ –≤–∫–ª—é—á–∞—Ç—å:**
   - –ß—Ç–æ –∏–∑–º–µ–Ω–µ–Ω–æ –∏ –∑–∞—á–µ–º
   - –ö–∞–∫ —ç—Ç–æ –≤–ª–∏—è–µ—Ç –Ω–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É
   - –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è (–µ—Å–ª–∏ –ø—Ä–∏–º–µ–Ω–∏–º–æ)

3. **–°–æ–∑–¥–∞–π—Ç–µ PR:**
   - –£–∫–∞–∂–∏—Ç–µ —Å–≤—è–∑–∞–Ω–Ω—ã–µ issues (–µ—Å–ª–∏ –µ—Å—Ç—å)
   - –î–æ–∂–¥–∏—Ç–µ—Å—å code review
   - –í–Ω–µ—Å–∏—Ç–µ –ø—Ä–∞–≤–∫–∏ –ø–æ –∑–∞–º–µ—á–∞–Ω–∏—è–º

## –ü—Ä–∞–≤–∏–ª–∞ —Ä–∞–±–æ—Ç—ã —Å –º–æ–¥—É–ª—è–º–∏

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞

–ï—Å–ª–∏ –≤—ã –¥–æ–±–∞–≤–ª—è–µ—Ç–µ –Ω–æ–≤—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç (–Ω–∞–ø—Ä–∏–º–µ—Ä, –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥):

1. **–°–æ–∑–¥–∞–π—Ç–µ –æ—Ç–¥–µ–ª—å–Ω—ã–π –º–æ–¥—É–ª—å** –≤ `src/`:
   ```python
   # src/command_handler.py
   class CommandHandler:
       """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –≥–æ–ª–æ—Å–æ–≤—ã—Ö –∫–æ–º–∞–Ω–¥."""
       # ...
   ```

2. **–î–æ–±–∞–≤—å—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é** –≤ `AppConfig` (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ):
   ```python
   # src/config.py
   @dataclass
   class AppConfig:
       # ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–æ–ª—è
       ollama_model: str | None = None
       whisper_model: str | None = None
       tts_model: str | None = None
       # ... –¥—Ä—É–≥–∏–µ –ø–æ–ª—è
       command_timeout: float | None = None  # –ù–æ–≤–æ–µ –ø–æ–ª–µ
   ```

3. **–ò–Ω—Ç–µ–≥—Ä–∏—Ä—É–π—Ç–µ –≤ `StrongServer`**:
   ```python
   # src/server.py
   from .command_handler import CommandHandler
   
   class StrongServer:
       def __init__(self, config: AppConfig, recorder_config: RecorderConfig | None = None):
           # ...
           self.command_handler = CommandHandler(config.command_timeout)
   ```

### –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –º–æ–¥—É–ª—è

–ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –º–æ–¥—É–ª—è:

1. **–°–æ—Ö—Ä–∞–Ω—è–π—Ç–µ –æ–±—Ä–∞—Ç–Ω—É—é —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å** ‚Äî –Ω–µ –ª–æ–º–∞–π—Ç–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π API
2. **–ù–µ –¥–æ–±–∞–≤–ª—è–π—Ç–µ —Å–∫—Ä—ã—Ç—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏** ‚Äî –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —è–≤–Ω—ã–º–∏
3. **–î–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è** ‚Äî –æ–±–Ω–æ–≤–∏—Ç–µ docstrings –∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏

### –ó–∞–º–µ–Ω–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥—Ä—É–≥–æ–π STT –¥–≤–∏–∂–æ–∫):

1. **–°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –º–æ–¥—É–ª—å** —Å —Ç–µ–º –∂–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º:
   ```python
   # src/stt_v2.py
   from __future__ import annotations
   from pathlib import Path
   
   class SpeechToTextV2:
       """–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è STT."""
       
       def __init__(self, model_name: str = "base"):
           """–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç –º–æ–¥–µ–ª—å."""
           # –ù–æ–≤–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è
       
       def transcribe(self, audio_path: Path, language: str = "ru") -> str:
           """–ü—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –∞—É–¥–∏–æ—Ñ–∞–π–ª –≤ —Ç–µ–∫—Å—Ç."""
           # –ù–æ–≤–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è
           return result
   ```

2. **–û–±–Ω–æ–≤–∏—Ç–µ `StrongServer`** –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –Ω–æ–≤–æ–≥–æ –º–æ–¥—É–ª—è:
   ```python
   # src/server.py
   from .config import AppConfig
   from .stt import SpeechToText
   from .stt_v2 import SpeechToTextV2
   
   class StrongServer:
       def __init__(self, config: AppConfig, recorder_config: RecorderConfig | None = None):
           # ...
           # –ú–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å —á–µ—Ä–µ–∑ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
           if config.use_new_stt:
               self.stt = SpeechToTextV2(config.whisper_model)
           else:
               self.stt = SpeechToText(config.whisper_model)
   ```

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ AppConfig

–¢–µ–∫—É—â–∏–µ –ø–æ–ª—è `AppConfig`:

- `ollama_model: str | None` ‚Äî –º–æ–¥–µ–ª—å Ollama (–Ω–∞–ø—Ä–∏–º–µ—Ä, "llama3.1:8b")
- `whisper_model: str | None` ‚Äî –º–æ–¥–µ–ª—å Whisper (tiny, base, small, medium, large)
- `tts_model: str | None` ‚Äî –≥–æ–ª–æ—Å–æ–≤–æ–π –ø—Ä–æ—Ñ–∏–ª—å Silero TTS (xenia, aidar, baya, kseniya, eugene)
- `tts_speed: float | None` ‚Äî —Å–∫–æ—Ä–æ—Å—Ç—å –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è TTS
- `tts_volume: float | None` ‚Äî –≥—Ä–æ–º–∫–æ—Å—Ç—å TTS
- `tts_sample_rate: int | None` ‚Äî —á–∞—Å—Ç–æ—Ç–∞ –¥–∏—Å–∫—Ä–µ—Ç–∏–∑–∞—Ü–∏–∏ –∞—É–¥–∏–æ (–Ω–∞–ø—Ä–∏–º–µ—Ä, 48000)
- `tts_gap_seconds: float | None` ‚Äî –ø–∞—É–∑–∞ –º–µ–∂–¥—É –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è–º–∏ –≤ —Å–µ–∫—É–Ω–¥–∞—Ö
- `system_prompt: str | None` ‚Äî —Å–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç –¥–ª—è LLM

### –†–∞–±–æ—Ç–∞ —Å config.json

- **–ù–µ —Ö–∞—Ä–¥–∫–æ–¥—å—Ç–µ –∑–Ω–∞—á–µ–Ω–∏—è** ‚Äî –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `AppConfig`
- **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `AppConfig.from_file()`** –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∏–∑ —Ñ–∞–π–ª–∞
- **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `AppConfig.default()`** –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
- **–î–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –Ω–æ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã** –≤ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è—Ö –∫ `AppConfig`
- **–í—Å–µ –ø–æ–ª—è –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã** ‚Äî –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `| None` –≤ type hints –¥–ª—è –Ω–æ–≤—ã—Ö –ø–æ–ª–µ–π

### –ü—Ä–∏–º–µ—Ä –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤–æ–≥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞:

1. –î–æ–±–∞–≤—å—Ç–µ –ø–æ–ª–µ –≤ `AppConfig`:
   ```python
   @dataclass
   class AppConfig:
       # ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–æ–ª—è
       ollama_model: str | None = None
       whisper_model: str | None = None
       # ...
       new_parameter: int | None = None  # –ù–æ–≤–æ–µ –ø–æ–ª–µ
   ```

2. –û–±–Ω–æ–≤–∏—Ç–µ –º–µ—Ç–æ–¥ `from_file`:
   ```python
   return cls(
       ollama_model=data.get("ollama_model"),
       whisper_model=data.get("whisper_model"),
       # ... –¥—Ä—É–≥–∏–µ –ø–æ–ª—è
       new_parameter=data.get("new_parameter"),  # –ù–æ–≤–æ–µ –ø–æ–ª–µ
   )
   ```

3. –î–æ–±–∞–≤—å—Ç–µ –≤ `config.json` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):
   ```json
   {
       "ollama_model": "llama3.1:8b",
       "whisper_model": "base",
       "new_parameter": 10
   }
   ```

### –†–∞–±–æ—Ç–∞ —Å –ø—Ä–æ–º–ø—Ç–∞–º–∏

–ü—Ä–æ–º–ø—Ç—ã —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ —Ñ–∞–π–ª–µ `prompts.json` –∏ —É–ø—Ä–∞–≤–ª—è—é—Ç—Å—è —á–µ—Ä–µ–∑ –º–æ–¥—É–ª—å `src/prompts.py`:

- **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é `get_prompt(key)`** –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø—Ä–æ–º–ø—Ç–∞ –ø–æ –∫–ª—é—á—É
- **–ü—Ä–æ–º–ø—Ç—ã –∫—ç—à–∏—Ä—É—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏** ‚Äî –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –æ–¥–∏–Ω —Ä–∞–∑ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –æ–±—Ä–∞—â–µ–Ω–∏–∏
- **–î–ª—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–æ–º–ø—Ç–æ–≤** –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `reload_prompts()` (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è `prompts.json`)
- **–ï—Å–ª–∏ –ø—Ä–æ–º–ø—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω**, —Ñ—É–Ω–∫—Ü–∏—è –≤–µ—Ä–Ω—ë—Ç `None`

–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:
```python
from src.prompts import get_prompt, reload_prompts

# –ü–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–æ–º–ø—Ç–∞
system_prompt = get_prompt("system_prompt_default")

# –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–æ–º–ø—Ç–æ–≤ (–µ—Å–ª–∏ –∏–∑–º–µ–Ω–∏–ª–∏ prompts.json)
reload_prompts()
```

–°—Ç—Ä—É–∫—Ç—É—Ä–∞ `prompts.json`:
```json
{
    "system_prompt_default": "–¢—ã –ø–æ–ª–µ–∑–Ω—ã–π –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç...",
    "other_prompt_key": "–î—Ä—É–≥–æ–π –ø—Ä–æ–º–ø—Ç..."
}
```

## –°—Ç–∏–ª—å –∫–æ–¥–∞

### –û–±—â–∏–µ –ø—Ä–∞–≤–∏–ª–∞

- **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ type hints** –≤–µ–∑–¥–µ, –≥–¥–µ –≤–æ–∑–º–æ–∂–Ω–æ
- **–ü–∏—à–∏—Ç–µ docstrings** –¥–ª—è –≤—Å–µ—Ö –ø—É–±–ª–∏—á–Ω—ã—Ö –∫–ª–∞—Å—Å–æ–≤ –∏ –º–µ—Ç–æ–¥–æ–≤
- **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `from __future__ import annotations`** –¥–ª—è –æ—Ç–ª–æ–∂–µ–Ω–Ω—ã—Ö –∞–Ω–Ω–æ—Ç–∞—Ü–∏–π
- **–°–ª–µ–¥—É–π—Ç–µ PEP 8** (–¥–ª–∏–Ω–∞ —Å—Ç—Ä–æ–∫–∏ 100 —Å–∏–º–≤–æ–ª–æ–≤ –¥–æ–ø—É—Å—Ç–∏–º–∞)

### –ò–º–µ–Ω–æ–≤–∞–Ω–∏–µ

- **–ö–ª–∞—Å—Å—ã:** `PascalCase` (–Ω–∞–ø—Ä–∏–º–µ—Ä, `SpeechToText`)
- **–§—É–Ω–∫—Ü–∏–∏ –∏ –º–µ—Ç–æ–¥—ã:** `snake_case` (–Ω–∞–ø—Ä–∏–º–µ—Ä, `transcribe_audio`)
- **–ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã:** `UPPER_SNAKE_CASE` (–Ω–∞–ø—Ä–∏–º–µ—Ä, `DEFAULT_SAMPLE_RATE`)
- **–ü—Ä–∏–≤–∞—Ç–Ω—ã–µ –º–µ—Ç–æ–¥—ã:** –Ω–∞—á–∏–Ω–∞—é—Ç—Å—è —Å `_` (–Ω–∞–ø—Ä–∏–º–µ—Ä, `_load_model`)

### –ò–º–ø–æ—Ä—Ç—ã

–ì—Ä—É–ø–ø–∏—Ä—É–π—Ç–µ –∏–º–ø–æ—Ä—Ç—ã:
```python
# –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞
import json
from pathlib import Path

# –°—Ç–æ—Ä–æ–Ω–Ω–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏
import torch
import whisper

# –õ–æ–∫–∞–ª—å–Ω—ã–µ –∏–º–ø–æ—Ä—Ç—ã
from .config import AppConfig
```

## –í–æ–ø—Ä–æ—Å—ã –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∞

–ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å –≤–æ–ø—Ä–æ—Å—ã:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ issues
2. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π issue —Å –≤–æ–ø—Ä–æ—Å–æ–º
3. –û–ø–∏—à–∏—Ç–µ –ø—Ä–æ–±–ª–µ–º—É –∏–ª–∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –¥–µ—Ç–∞–ª—å–Ω–æ

## –õ–∏—Ü–µ–Ω–∑–∏—è

–í–Ω–æ—Å—è –∏–∑–º–µ–Ω–µ–Ω–∏—è, –≤—ã —Å–æ–≥–ª–∞—à–∞–µ—Ç–µ—Å—å —Å —Ç–µ–º, —á—Ç–æ –≤–∞—à –≤–∫–ª–∞–¥ –±—É–¥–µ—Ç –ª–∏—Ü–µ–Ω–∑–∏—Ä–æ–≤–∞–Ω –ø–æ–¥ —Ç–æ–π –∂–µ –ª–∏—Ü–µ–Ω–∑–∏–µ–π, —á—Ç–æ –∏ –ø—Ä–æ–µ–∫—Ç (—Å–º. —Ñ–∞–π–ª LICENSE).

---

**–°–ø–∞—Å–∏–±–æ –∑–∞ –≤–∞—à –≤–∫–ª–∞–¥ –≤ VoiceToNights!** üéôÔ∏è‚ú®

